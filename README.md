# 操作系统-精髓与设计原理

> 操作系统利用一个或多个处理器的硬件资源，为系统用户提供一组服务，它还代表用户来管理辅助存储器和输入输出（`Input/Output, IO`）设备。因此，从最顶层看，一台计算机由处理器、存储器和输入/输出部件组成，每类部件都有一个或者多个模块。这些部件以某种方式互联，以实现计算机执行程序的主要功能。

主要探讨了操作系统中关于`memory`管理、淘汰算法及虚拟内存机制、线程和进程内容（并发控制）：

1. [进程的描述和控制](./threads-smp-microkernels.md)部分
2. [线程、对称多处理(`SMP`)和微内核](./threads-smp-microkernels.md)
3. [并发性：互斥和同步](./concurrency:Mutual-exclusion-and-synchronization.md)
4. [内存管理](./memory-management.md)内容
5. [虚拟内存设计](./virtual-memory.md)
6. [多处理器和实时调度](./multiprocessor-and-realtime-scheduling.md)
7. [并发：死锁和饥饿](./concurrency:deadlock-and-starvation.md)

## 一、进程管理
2021.下列操作中，操作系统在创建新进程时，必须完成的是（a，b）。a.申请空白的进程控制块  b.初始化进程控制块  c.设置金策红状态为执行态。
> Note: 进程的创建步骤为：申请一个空白的`PCB`（进程控制块）、为新进程分配资源（程序、数据及用户栈分配必要的内存）、初始化`PCB`块以及将新进程插入到就绪队列。

2021.对于"中断处理结束"、"进程阻塞"、"进程执行结束"和"进程时间片用完"的操作，会引起进程调度程序的执行。此外，常考察进程状态的转换，分时系统`CPU`时间片用完或主动出让`CPU`，线程会由执行态转换为就绪态。用户级线程完全由用户管理，多线程模型的多对一模式，当一个线程使用内核服务时被阻塞，则整个进程都会被阻塞。

死锁产生的必要条件有：a.互斥条件、b.不剥夺条件、c.请求保持条件、d.循环等待条件，死锁的处理策略有死锁预防、避免死锁和死锁的检测及解除。对于死锁避免，常会考察安全序列和银行家算法。

2020.系统中有`A`、`B`类资源各`6`个，`t`时刻资源分配及需求情况如表所示。计算安全序列时，会涉及资源相关矩阵如`Need`=`Max`-`Allocated`，`Need`矩阵结果为：{(4, 4), (3, 1), (3, 4)} - {(2, 3), (2, 1), (1, 2)} = {(2 1), (1， 0), (2，2)}。

进程  | A已分配数量 | B已分配数量 | A需求总量    | B需求总量 |
---- | --------- | ----------| ----------|---------| 
P1     |        2         |      3           |       4          |       4        | 
P2    |        2         |       1           |       3          |       1        | 
P3    |        1          |      2           |       3          |       4        | 
`A`、`B`各类资源各`6`个，除去`3`个进程已分配的资源，还剩`A`、`B`为(1, 0)，故只有`P2`满足条件，分配给`P2`其执行完成后，`A`、`B`的资源为(3, 1)。此时满足`P1`的要求，分配给`P1`。等其执行完成后，最后将所有资源分配给`P3`，最后构成安全序列为（P1，P2，P3）。



